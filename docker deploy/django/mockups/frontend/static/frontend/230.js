(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[230],{5221:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>w});var a=n(6540),r=n(6347),c=n(5589),s=n(5090),l=n(1960);const o=function({hsva:e,setHsva:t}){return a.createElement("div",{className:"flex flex-col items-center space-y-4 p-4 bg-white rounded-md shadow-md"},a.createElement("h1",null,"Choose your product color:"),a.createElement(l.A,{color:e,onChange:n=>t({...e,...n.hsva})}),a.createElement(c.A,{color:e,onChange:n=>t({...e,...n.hsva})}),a.createElement(s.A,{hsva:e,style:{width:210,marginTop:20},onChange:n=>{t({...e,...n})}}))};var i=n(9437),m=n(4092),u=n(6764);const d=function({color:e,textureImage:t,glb:n,mockupName:r}){const c=(0,a.useRef)(),s=(0,a.useRef)(),l=(0,a.useRef)(),o=(0,a.useRef)(),d=(0,a.useRef)(),f=(0,a.useRef)();return(0,a.useEffect)((()=>{let e;const a=o.current,r=o.current.clientWidth,u=o.current.clientHeight,g=new i.JeP({antialias:!0}),p=new i.Z58,h=r/u,E=new i.qUd(2*-h,2*h,2,-2,.1,51);return g.setSize(r,u),o.current.appendChild(g.domElement),c.current=p,s.current=g,l.current=E,E.position.z=51,(new m.B).load(n,(e=>{e.scene.traverse((e=>{if(e.isMesh&&"image"===e.name){const t=e.material.map;e.material=new i.V9B({map:t})}if(e.isMesh&&"geometry"===e.name){const n=(new i.Tap).load(t);n.flipY=!1,n.colorSpace=i.er$,e.material=new i.V9B({map:n,visible:!0}),e.material.transparent=!0,e.material.opacity=1,f.current=n}if(e.isMesh&&"shades"===e.name&&(e.material.transparent=!0,e.material.opacity=.4,e.material.needsUpdate=!0),e.isMesh&&"mockupArea"===e.name){const t=new i.V9B({transparent:!0,opacity:.8});e.material=t,d.current=t}})),p.add(e.scene)}),void 0,(function(e){console.error(e)})),function t(){e=requestAnimationFrame(t),g.render(p,E)}(),()=>{cancelAnimationFrame(e),a.removeChild(g.domElement),p.traverse((e=>{if(e.isMesh)if(e.geometry.dispose(),e.material.isMaterial)v(e.material);else for(const t of e.material)v(t)})),g.dispose()};function v(e){e.dispose();for(const t of Object.keys(e)){const n=e[t];n&&"object"==typeof n&&"minFilter"in n&&n.dispose()}}}),[]),(0,a.useEffect)((()=>{d.current&&d.current.color.set((0,u.D9)(e))}),[e]),(0,a.useEffect)((()=>{console.log(t),f.current&&t&&(new i.Tap).load(t,(function(e){e.flipY=!1,e.colorSpace=i.er$,f.current.image=e.image,f.current.needsUpdate=!0}))}),[t]),a.createElement("div",null,a.createElement("div",{className:"threejs-app",ref:o}),a.createElement("div",{className:"p-4 bg-white rounded-md shadow-md"},a.createElement("button",{className:"btn btn-block btn-primary p-4",onClick:()=>{const e=o.current.clientWidth,t=o.current.clientHeight,n=1024*t/e;s.current.setSize(1024,n),s.current.render(c.current,l.current);const a=s.current.domElement.toDataURL("image/png"),i=document.createElement("a");i.href=a,i.download=r+".png",s.current.setSize(e,t),i.click()}},"Download Mockup")))};var f=n(5370);const g=function({size:e,isCenterHorizontally:t,isCenterVertically:n,image:r,onTextureImageChange:c,templateImage:s,imageHeight:l,imageWidth:o}){const i=(0,a.useRef)(null),m=(0,a.useRef)(null),[u,d]=(0,a.useState)(null),g=(0,a.useRef)();(0,a.useEffect)((()=>{const e=new f.lgM({background:"#ffffff",width:o,height:l,transparent:!0});g.current=e;const t=new f.A1g;t.beginFill(16777215,0),t.drawRect(0,0,e.screen.width,e.screen.height),t.endFill();const n=e.renderer.generateTexture(t),a=new f.kxk(n),r=new f.mcf;r.addChild(a),console.log("image:",s);const c=f.kxk.from(s);c.anchor.set(.5),c.x=o/2,c.y=l/2,m.current=c,c.eventMode="dynamic",c.buttonMode=!0;let u=!1,d=0,h=0;return c.on("pointerdown",(e=>{u=!0,d=e.global.x,h=e.global.y})).on("pointerup",(()=>{u=!1,p()})).on("pointerupoutside",(()=>{u=!1,p()})).on("pointermove",(e=>{if(u){const t=e.global.x,n=e.global.y;c.x+=t-d,c.y+=n-h,d=t,h=n}})),r.addChild(c),e.stage.addChild(r),i.current.appendChild(e.view),()=>{e.destroy(!0,{children:!0,texture:!0,baseTexture:!0})}}),[]),(0,a.useEffect)((()=>{m.current.scale.set(e/100),p()}),[e]),(0,a.useEffect)((()=>{m.current.x=o/2,p()}),[t]),(0,a.useEffect)((()=>{m.current.y=l/2,p()}),[n]),(0,a.useEffect)((()=>{if(r){const e=f.gPd.from(r);m.current.texture=e,g.current.render(),p()}}),[r]),(0,a.useEffect)((()=>{u&&(c(u),p())}),[u]);const p=()=>{const e=g.current.renderer,t=g.current.stage,n=e.extract,a=new f.M_G(0,0,g.current.screen.width,g.current.screen.height),r=n.canvas(t,a).toDataURL("image/png",1);d(r)};return a.createElement("div",null,a.createElement("div",{className:"border-dashed border-2 border-sky-500",ref:i}))},p=function({setIsCenterVertically:e}){return a.createElement("button",{className:"btn btn-block",onClick:()=>{e((e=>!e))}},"Center Vertically")},h=function({setIsCenterHorizontally:e}){return a.createElement("button",{className:"btn btn-block",onClick:()=>{e((e=>!e))}},"Center Horizontally")},E=function({size:e,setSize:t}){return console.log(e),a.createElement("div",{className:"space-y-4"},a.createElement("h1",null,"Change your image size:"),a.createElement("input",{type:"range",min:0,max:"120",value:e,className:"range",onChange:e=>{t(Number(e.target.value))}}))},v=function({setImage:e}){const t=(0,a.useRef)();return a.createElement("div",{className:"flex"},a.createElement("input",{type:"file",ref:t,style:{display:"none"},onChange:t=>{const n=t.target.files[0];if(n){const t=new FileReader;t.onloadend=()=>{e(t.result)},t.readAsDataURL(n)}}}),a.createElement("button",{className:"btn btn-block btn-primary",onClick:()=>{t.current.click()}},"Add Your Design"))},b=function({onTextureImageChange:e,templateImage:t,imageHeight:n,imageWidth:r}){const[c,s]=(0,a.useState)(!0),[l,o]=(0,a.useState)(!0),[i,m]=(0,a.useState)(50),[u,d]=(0,a.useState)(t);return a.createElement("div",{className:""},a.createElement("div",null,a.createElement(g,{size:i,isCenterHorizontally:l,isCenterVertically:c,image:u,onTextureImageChange:e,templateImage:t,imageHeight:n,imageWidth:r})),a.createElement("div",{className:"flex flex-col space-y-4 p-4 bg-white rounded-md shadow-md"},a.createElement(v,{setImage:d}),a.createElement("div",{className:"flex justify-between space-x-4"},a.createElement("div",{className:"w-1/2"},a.createElement(p,{setIsCenterVertically:s})),a.createElement("div",{className:"w-1/2"},a.createElement(h,{setIsCenterHorizontally:o}))),a.createElement(E,{size:i,setSize:m})))},w=function(){const{slug:e}=(0,r.useParams)(),[t,n]=(0,a.useState)(null),[c,s]=(0,a.useState)(!1),[l,i]=(0,a.useState)({h:214,s:43,v:90,a:1}),[m,u]=(0,a.useState)(null);return(0,a.useEffect)((()=>{fetch(`/api/mockuptemplates/${e}/`).then((e=>{if(!e.ok)throw 404===e.status&&s(!0),new Error("Network response was not ok");return e.json()})).then((e=>n(e))).catch((e=>console.error("Error:",e)))}),[e]),c?a.createElement("div",null,"404 Not Found"):a.createElement("div",{className:"flex justify-center"},a.createElement("div",{className:"w-full p-4"},t&&a.createElement("div",{className:"flex justify-center space-x-4"},a.createElement("div",{className:""},a.createElement(b,{onTextureImageChange:e=>{u(e)},templateImage:t.templateImage,imageHeight:t.templateImageHeight,imageWidth:t.templateImageWidth})),a.createElement("div",{className:""},a.createElement(o,{hsva:l,setHsva:i})),a.createElement("div",{className:""},a.createElement("div",{className:"w-full aspect-w-1 aspect-h-1"},a.createElement(d,{color:l,textureImage:m,glb:t.glb,mockupName:t.name}))))))}},2634:()=>{}}]);